<div class="game-container">
  @if (showGameBoard()) {
    <!-- Milestone 4 Game Board UI with Real Gameplay -->
    <app-game-board
      [playerCardCount]="playerCardCount()"
      [opponentCardCount]="opponentCardCount()"
      [playerActiveCard]="playerActiveCard()"
      [opponentActiveCard]="opponentActiveCard()"
      [playerCardGlow]="playerCardGlow()"
      [opponentCardGlow]="opponentCardGlow()"
      [gameMessage]="gameMessage()"
      [challengeAvailable]="challengeAvailable()"
      [canPlayerAct]="canPlayerAct()"
      (playerDeckClicked)="onPlayerDeckClick()">
    </app-game-board>

    <!-- Challenge Prompt Modal -->
    @if (showChallengePrompt()) {
      <div class="challenge-overlay">
        <mat-card class="challenge-card">
          <mat-card-header>
            <mat-card-title>Challenge Available!</mat-card-title>
            <mat-card-subtitle>Do you want to challenge the result?</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <p>You lost this round, but you can draw an additional card to challenge the result.</p>
            <p><strong>Risk:</strong> If you lose the challenge, you lose both cards!</p>
          </mat-card-content>
          <mat-card-actions>
            <button mat-raised-button color="primary" (click)="acceptChallenge()">
              Accept Challenge
            </button>
            <button mat-button (click)="declineChallenge()">
              Decline
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    }

    <!-- Game Controls -->
    <div class="game-controls">
      <button mat-raised-button color="primary" (click)="startNewGame()">
        New Game
      </button>
      <button mat-button (click)="toggleDemo()">
        Show Old Demo
      </button>
    </div>
  } @else {
    <!-- Original Milestone 2 Demo -->
    <mat-card class="welcome-card">
      <mat-card-header>
        <mat-card-title>War of Attrition - Milestone 3 Complete! ðŸŽ‰</mat-card-title>
        <mat-card-subtitle>Basic UI Components Implementation</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <p><strong>Milestone 3 has been successfully completed!</strong> Core UI components are implemented and functional.</p>
        
        <h3>New UI Components:</h3>
        <ul>
          <li><strong>Game Board Layout:</strong> Head-to-head player layout with solitaire green background</li>
          <li><strong>Card Component:</strong> Visual card representation with red/black suits and glow effects</li>
          <li><strong>Health Bar Component:</strong> Color-coded health bars (Greenâ†’Yellowâ†’Orangeâ†’Red)</li>
          <li><strong>Action Indicators:</strong> Blue glow effects for player actions</li>
        </ul>

        <h3>Previous - Game Engine Demo:</h3>
        <div class="demo-output">
          @for (line of demoLog(); track $index) {
            <div class="demo-line">{{ line }}</div>
          }
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button mat-raised-button color="primary" (click)="toggleDemo()">
          Show New Game Board
        </button>
        <button mat-raised-button color="primary" (click)="runDemo()">Run Demo Again</button>
        <button mat-button routerLink="/settings">Settings</button>
      </mat-card-actions>
    </mat-card>
  }
</div>
